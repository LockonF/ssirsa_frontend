<div ng-cloak>
    <md-toolbar class="md-medium-tall">
        <div class="md-toolbar-tools" layout="row" layout-sm="column" layout-xs="column" layout-align="space-between end">
            <div>
                <h2>
                    <span>Etapa de Servicio</span>
                </h2>
            </div>

            <div layout="row">
                <md-button class="md-raised" aria-label="Guardar"
                           ng-click='vm.crearEtapaServicio()'>
                    <md-icon md-font-icon="fa fa-save"></md-icon>

                </md-button>
                <md-button class="md-raised" aria-label="Guardar"
                           ng-click="vm.limpiar()">
                    <md-icon md-font-icon="fa fa-eraser"></md-icon>

                </md-button>
                <md-button class="md-raised" aria-label="Guardar"
                           ng-click="vm.eliminar()">
                    <md-icon md-font-icon="fa fa-trash"></md-icon>

                </md-button>
            </div>
        </div>
    </md-toolbar>
    <md-content>
        <md-tabs md-dynamic-height md-border-bottom>
            <md-tab label="InformaciÃ³n de Etapa">
                <md-content class="md-padding">
                    <div flex="100" layout="row">
                        <div layout="column" flex="80">
                            <md-input-container flex="50">
                                <label>Id de Cabinet</label>
                                <input type="text" ng-model="vm.idCabinet"/>
                            </md-input-container>
                            <div layout="row">
                                <md-input-container flex="30">
                                    <label>No. de Diagnostico</label>
                                    <input type="text" ng-model="vm.diagnostico.id" ng-disabled="true"/>
                                </md-input-container>
                                <md-input-container flex="35">
                                    <label translate>Etapa Actual</label>
                                    <md-select ng-model="vm.etapaActual.actual_etapa" name="select" ng-disabled="true">
                                        <md-option ng-repeat="etap in vm.etapas" ng-value="etap.value">{{etap.nombre}}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                                <md-input-container flex="35">
                                    <label translate>Etapa Siguiente</label>
                                    <md-select ng-model="vm.etapaActual.siguiente_etapa" name="select"
                                               ng-disabled="vm.editable">
                                        <md-option ng-repeat="etap in vm.etapas" ng-value="etap.value">{{etap.nombre}}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                            <div layout="row">
                                <md-input-container flex>
                                    <label>Economico</label>
                                    <input type="text" ng-model="vm.cabinet.economico" ng-disabled="true"/>
                                </md-input-container>
                                <md-input-container flex>
                                    <label translate>Estado Actual</label>
                                    <input type="text" ng-model="vm.cabinet.status" ng-disabled="true"/>

                                </md-input-container>
                                <md-input-container flex>
                                    <label>Incidencias</label>
                                    <input type="number" ng-model="vm.cabinet.no_incidencias" ng-disabled="true"/>
                                </md-input-container>
                            </div>

                        </div>
                        <div layout="row" flex="20">
                            <div layout="column">
                                <div layout="row" layout-sm="column" layout-xs="column">
                                    <md-input-container flex>
                                        <md-button class="md-fab" class="md-primary" aria-label="fab button"
                                                   ng-click="vm.buscar()">
                                            <md-icon md-font-icon="zmdi zmdi-zoom-in"></md-icon>
                                        </md-button>
                                    </md-input-container>
                                    <md-input-container flex>
                                        <md-button class="md-fab" class="md-primary" aria-label="fab button"
                                                   ng-click="vm.editar()">
                                            <md-icon md-font-icon="fa fa-pencil"></md-icon>
                                        </md-button>
                                    </md-input-container>
                                </div>
                            </div>
                        </div>


                    </div>
                </md-content>
            </md-tab>

            <md-tab label="Insumos de la Etapa">
                <md-content class="md-padding">
                    <div layout="row">
                        <md-input-container flex="25">
                            <label translate>Insumo</label>
                            <md-select ng-model="vm.insumo" name="select" ng-disabled="vm.editable">
                                <md-option ng-repeat="insu in vm.insumos" ng-value="insu">{{insu.nombre}}</md-option>
                            </md-select>
                        </md-input-container>
                        <md-input-container flex="15">
                            <label>Cantidad</label>
                            <input type="number" ng-model="vm.insumo.cantidad" ng-disabled="vm.editable"/>
                        </md-input-container>
                        <md-input-container flex="50">
                            <label>Notas</label>
                            <input type="text" ng-model="vm.insumo.notas" ng-disabled="vm.editable"/>
                        </md-input-container>
                        <md-input-container flex="10">
                            <md-button class="md-primary md-raised" aria-label="raised button"
                                       ng-click='vm.crearInsumo()'>
                                <md-icon md-font-icon="zmdi zmdi-plus"></md-icon>
                            </md-button>
                        </md-input-container>
                    </div>
                    <div layout="row" layout-sm="column" layout-md="column" ng-show="vm.insumos">
                        <md-table-container>
                            <table md-table="" md-row-select="" ng-model="vm.insumo" flex="100">
                                <thead md-head="" md-order="vm.query.order">
                                <tr md-row="md-row">
                                    <th md-column="md-column" md-order-by="nombre" flex="25"><span
                                            translate="">Nombre</span></th>
                                    <th md-column="md-column" md-order-by="cantidad" flex="15"><span translate="">Cantidad</span>
                                    <th md-column="md-column" md-order-by="notas" flex="50"><span
                                            translate="">Notas</span>
                                        <!-- Cuerpo de la tabla-->
                                    </th>
                                </tr>
                                </thead>
                                <tbody md-body="md-body">
                                <tr md-row="md-row" md-select="insu" md-select-id="{{insu.id}}"
                                    ng-repeat="insu in vm.insumos| orderBy:vm.query.order">
                                    <td md-cell="md-cell" flex="25">{{insu.nombre}}</td>
                                    <td md-cell="md-cell" flex="15">{{insu.cantidad}}</td>
                                    <td md-cell="md-cell" flex="50">{{insu.notas}}</td>
                                    <td md-cell="md-cell" ng-click="$event.stopPropagation()" flex="10">
                                        <md-button ng-click="vm.eliminarInsumo(insu)" class="md-fab md-warn md-mini">
                                            <md-icon md-font-icon="fa fa-times-circle"></md-icon>
                                        </md-button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </md-table-container>
                    </div>
                </md-content>
            </md-tab>
        </md-tabs>
    </md-content>
</div>
